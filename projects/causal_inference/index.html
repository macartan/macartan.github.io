<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Causal inference | Macartan Humphreys</title> <meta name="author" content="Macartan Humphreys"> <meta name="description" content="Macartan Humphreys "> <meta name="keywords" content="political-science, macartan-humphreys, international-development, wzb, humboldt, tcd"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/mh.png"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://macartan.github.io/projects/causal_inference/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <img src="https://macartan.github.io/assets/img/WZB_dots.png" alt=" WZB " style="width:20%"><span class="do-dahrendorf">Macartan </span><span class="font-weight-bold">Humphreys</span> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">packages</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">teaching</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/teaching/">classes</a> <a class="dropdown-item" href="/teaching/resources">resources</a> <a class="dropdown-item" href="/teaching/slides">slides</a> <a class="dropdown-item" href="/teaching/applying-for-a-phd">applying for a PhD</a> <div class="dropdown-divider"></div> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">writing</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/writing/by_year">all writing</a> <a class="dropdown-item" href="/writing/by_topic">by topic</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/writing/books">books</a> <a class="dropdown-item" href="/writing/articles">articles</a> <a class="dropdown-item" href="/writing/working_papers">unpublished</a> <a class="dropdown-item" href="https://macartan.github.io/blog/">posts</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/about/">About</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Causal inference</h1> <p class="post-description"></p> </header> <article> <h2 id="book-on-causal-models-for-qualititative-and-mixed-methods-research">Book on causal models for qualititative and mixed methods research</h2> <p>Alan Jacobs and I have been working on figuring out principles for simultaneously drawing inferences from qualitative and quantitative data. The key idea is that when scholars use qualitative inference they update beliefs about causal effects (or more, generally about their model of the world, \(M\)) by making inferences using data about many facts of a given case (\(D_1\)). They estimate a posterior \(\Pr(M \vert D_1)\). Quantitative scholars update beliefs about causal effects by making inferences using data about a few facts about many cases (\(D_2\)), forming posterior \(\Pr(M \mid D_2)\). From there it’s not such a huge thing to make integrated inferences of the form \(\Pr(M \vert D_1\&amp;D_2)\).</p> <p>Simple as that sounds, people do not do this, but doing it opens up many insights about how we learn from cases and how we aggregate knowledge. The broad approach becomes considerably more powerful when causal models are used to justify beliefs on data patterns.</p> <p>Alan and I develop these ideas in our book <i class="fas fa-book"></i> <a href="https://macartan.github.io/integrated_inferences/"> Integrated inferences</a> (with Alan Jacobs, Cambridge University) and provide a package <a href="https://github.com/macartan/CausalQueries" rel="external nofollow noopener" target="_blank">CausalQueries</a> to implement these ideas. (See also our <a href="https://macartan.github.io/causalmodels/">guide to our package for making, updating, and querying causal models</a>).</p> <p>Legacy: See an earlier working paper with core ideas in the book: <a href='"2017_qualdag.pdf"'>Qualitative inferences from Causal Models</a></p> <h2 id="pedagogical-material">Pedagogical material</h2> <ul> <li> <table> <tbody> <tr> <td><a href="https://macartan.github.io/ci/ci_2024.html#/title-slide">Lectures on causal inference</a></td> <td><a href="https://macartan.github.io/ci/">exercises etc</a></td> </tr> </tbody> </table> <ul> <li><a href="https://macartan.github.io/ci/1.1_intro.html">Intro</a></li> <li><a href="https://macartan.github.io/ci/1.2_declaredesign.html">Design declaration</a></li> <li><a href="https://macartan.github.io/ci/2.1_causality.html">Causality</a></li> <li><a href="https://macartan.github.io/ci/2.2_estimands.html">Estimands and Identification</a></li> <li><a href="https://macartan.github.io/ci/3.1_fisher.html">Frequentists inference</a></li> <li><a href="https://macartan.github.io/ci/3.2_bayes.html">Bayesian inference</a></li> <li><a href="https://macartan.github.io/ci/4.1_design.html">Experimental design</a></li> <li><a href="https://macartan.github.io/ci/4.2_evaluation.html">Design evaluation</a></li> <li><a href="https://macartan.github.io/ci/5.1_topics.html">Topics (Diff in Diff, RDD, IV, other)</a></li> <li><a href="https://macartan.github.io/ci/5.2_process.html">Workflows</a></li> </ul> </li> </ul> <p>Other</p> <ul> <li> <p><i class="fas fa-presentation"></i> <a href="/slides/201807_Berlin_Summer_School.pdf" rel="noopener noreferrer"> Of causes and postulates: Slides for the Berlin summer school in social sciences 2018</a></p> </li> <li> <p><i class="fas fa-link"></i> <a href="https://egap.org/resource/10-strategies-for-figuring-out-if-x-caused-y/" rel="external nofollow noopener" target="_blank">Ten strategies for figuring out causal effects</a></p> </li> <li> <p><i class="fas fa-link"></i> <a href="https://egap.org/resource/10-things-to-know-about-causal-inference/" rel="external nofollow noopener" target="_blank"> Ten things you need to know about causal inference</a></p> </li> <li> <p><i class="fas fa-link"></i> <a href="https://egap.org/methods-guides/" rel="external nofollow noopener" target="_blank"> Other egap guides</a></p> </li> </ul> <h2 id="short-working-papers">Short working papers</h2> <div class="publications"> <ol class="bibliography"> <li> <div class="row"> <div class="col-sm-2 abbr"><abbr class="badge">JCI</abbr></div> <div id="humphreys2009bounds" class="col-sm-8"> <div class="title">Bounds on the fixed effects estimand in the presence of heterogeneous assignment propensities</div> <div class="author"> <em>Macartan Humphreys</em> </div> <div class="periodical"> <em>Journal of Causal Inference</em> 2025 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a> <a href="https://www.degruyterbrill.com/document/doi/10.1515/jci-2024-0040/html" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">HTML</a> <a href="/assets/pdf/papers/2025_FE.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> <a href="https://macartan.github.io/code/JCI_2025_code.html" class="btn btn-sm z-depth-0" role="button">Code</a> </div> <div class="abstract hidden"> <p>Fixed effects estimation, with linear controls for stratum membership, is often used to estimate treatment effects when assignment propensities differ across strata. In the presence of heterogeneity in treatment effects across strata, this estimator does not target the average treatment effect, however. Indeed, the implied estimand can range anywhere from the lowest to the highest stratum-level average effect. To facilitate the interpretation of results using this approach, I establish that if stratum-level average effects are monotonic in the shares assigned to treatment, then the fixed effects estimand lies between the average treatment effect for the treated and the average treatment effect for the controls.</p> </div> <div class="bibtex hidden"> <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@article</span><span class="p">{</span><span class="nl">humphreys2009bounds</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Bounds on the fixed effects estimand in the presence of heterogeneous assignment propensities}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Humphreys, Macartan}</span><span class="p">,</span>
  <span class="na">journal</span> <span class="p">=</span> <span class="s">{Journal of Causal Inference}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{2025}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure> </div> </div> </div> </li> <li> <div class="row"> <div class="col-sm-2 abbr"><abbr class="badge" style="background-color:grey"><a href="">WP</a></abbr></div> <div id="tietz2023" class="col-sm-8"> <div class="title">Making, Updating, and Querying Causal Models using CausalQueries</div> <div class="author"> <a href="https://github.com/till-tietz" rel="external nofollow noopener" target="_blank">Till Tietz</a>, <a href="https://lilymedina.github.io/" rel="external nofollow noopener" target="_blank">Lily Medina</a>, Georgiy Syunyaev, and <em>Macartan Humphreys</em> </div> <div class="periodical"> 2023 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a> <a href="/assets/pdf/papers/2024_CausalQueries.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="abstract hidden"> <p>The R package CausalQueries can be used to make, update, and query causal models. Users provide a causal statement of the form X -&gt; M &lt;- Y; M &lt;-&gt; Y which is interpreted as a structural causal model over a collection of binary variables. CausalQueries can then (1) identify the set of principal strata—causal types—required to characterize all possible types of causal relations between nodes consistent with the causal statement (2) determine a set of parameters needed to characterize distributions over these types (3) update beliefs over the distribution of causal types, using a stan model and (4) pose a wide range of causal queries of the model, using either the prior distribution, the posterior distribution, or a user-specified candidate vector of parameters</p> </div> <div class="bibtex hidden"> <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@unpublished</span><span class="p">{</span><span class="nl">tietz2023</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Making, Updating, and Querying Causal Models using CausalQueries}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Tietz, Till and Medina, Lily and Syunyaev, Georgiy and Humphreys, Macartan}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{2023}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure> </div> </div> </div> </li> <li> <div class="row"> <div class="col-sm-2 abbr"><abbr class="badge" style="background-color:grey"><a href="">WP</a></abbr></div> <div id="hj2017" class="col-sm-8"> <div class="title">Qualitative Inference from Causal Models</div> <div class="author"> <em>Macartan Humphreys</em>, and <a href="https://politics.ubc.ca/persons/alan-jacobs/" rel="external nofollow noopener" target="_blank">Alan Jacobs</a> </div> <div class="periodical"> 2017 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a> <a href="/assets/pdf/papers/2017_qualdag.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="abstract hidden"> <p>Process tracing is a strategy for inferring within-case causal effects from observable implications of causal processes. Bayesian nets, developed by computer scientists and used now in many disciplines, provide a natural framework for describing such processes, characterizing causal estimands, and assessing the value added of additional information for understanding different causal estimands. We describe how these tools can be used by scholars of process tracing to justify inference strategies with reference to lower level theories and to assess the probative value of new within-case information.</p> </div> <div class="bibtex hidden"> <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@unpublished</span><span class="p">{</span><span class="nl">hj2017</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Qualitative Inference from Causal Models}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Humphreys, Macartan and Jacobs, Alan}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{2017}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure> </div> </div> </div> </li> <li> <div class="row"> <div class="col-sm-2 abbr"><abbr class="badge" style="background-color:grey"><a href="">WP</a></abbr></div> <div id="bayesian2016" class="col-sm-8"> <div class="title">Why a Bayesian researcher might prefer observational data</div> <div class="author"> <em>Macartan Humphreys</em> </div> <div class="periodical"> 2016 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a> <a href="/assets/pdf/papers/2016_Curse_of_Control.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="abstract hidden"> <p>"I give an illustration of a simple problem in which a Bayesian researcher can choose between random assignment of a treatment or delegating assignment to an informed—but motivated—agent. In effect she compares between learning from an RCT or from an observational study. She evaluates designs according to an expected squared error criterion (ESE). I show that for a small problem (n “ 2) if she starts with a prior expectation of no treatment effect but believes that the agent is an advocate of treatment with probability q (and otherwise an opponent) then for all values of q she does at least as well delegating assignment as she does from an RCT and she does strictly better as long as q ≠0.5. For other priors on treatment effects, randomization can dominate delegation or be dominated by it. As n grows the expected errors from an RCT design fall but errors from delegated assignment do not. Although there is always some prior such that a delegated procedure beats randomized assignment, the converse is not true. For a given prior there may be no delegated procedure that trumps an RCT. With uniform priors for example the RCT dominates delegated assignment for all beliefs on agent motivations when n ≥4."</p> </div> <div class="bibtex hidden"> <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@unpublished</span><span class="p">{</span><span class="nl">bayesian2016</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Why a Bayesian researcher might prefer observational data}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Humphreys, Macartan}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{2016}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure> </div> </div> </div> </li> <li> <div class="row"> <div class="col-sm-2 abbr"><abbr class="badge" style="background-color:grey"><a href="">WP</a></abbr></div> <div id="chen2010" class="col-sm-8"> <div class="title">Technology Diffusion and Social Networks: Evidence from a Field Experiment in Uganda</div> <div class="author"> Jiehua Chen, <em>Macartan Humphreys</em>, and Vijay Modi</div> <div class="periodical"> 2010 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a> <a href="/assets/pdf/papers/2010_stoves.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="abstract hidden"> <p>We examine technology diffusion in rural Uganda, with a focus on the effectiveness of decentralized marketing to encourage the adoption of improved fuelwood cookstoves. Identifying the effects of a dissemination scheme is rendered difficult by the possibility of spillover effects—that areas that are not targeted with a new technology are nevertheless indirectly affected via targeting of their neighbors. To address this concern, we use a novel randomization scheme to allocate ambassadors to communities in a way that can allow for the identification of direct and indirect effects. We find evidence for positive direct and spillover effects on the knowledge of the stoves, but found little evidence of either direct or indirect effects on purchase decision. Our results are consistent with no impact of this scheme on takeup but we note that we cannot rule out the possibility of effects coupled with spillovers that do not decline appreciably over the ranges that we study.</p> </div> <div class="bibtex hidden"> <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@unpublished</span><span class="p">{</span><span class="nl">chen2010</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Technology Diffusion and Social Networks: Evidence from a Field Experiment in Uganda}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Chen, Jiehua and Humphreys, Macartan and Modi, Vijay}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{2010}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure> </div> </div> </div> </li> </ol> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © 2025 Macartan Humphreys. by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a>. Impressum &amp; Datenschutzerklärung </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>