knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(kableExtra)
library(fabricatr)
hist(rnorm(20))
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
run <- FALSE
cref <- function(x) paste0("[`", x, "`](#", x, ") (\\ref{", x, "})") |> eval()
library(tidyverse)
library(knitr)
expand_grid(T1 = c("No", "Yes"),
T2 = c("No", "Yes"),
T3a = c("Yes", "No"),
T3b = c("Yes", "No")) |>
mutate(Variation = 1:n() ) |>
select(Variation, `T1: Quota in choice 1?` = T1, `T2: Information on scores?` = T2, `T3.1: Discussion choice 1?` = T3a,  `T3.2: Discussion choice 2?` = T3b) |>
kable(bookends = TRUE, align = "c")
knitr::include_graphics("input/vignette_1.png")
knitr::include_graphics("input/vignette_post_exp.png")
knitr::include_graphics("../../4_ethics/columbia_irb/WZB_consent_form_revised_v4.pdf")
knitr::include_graphics("input/ravens.png")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(latex2exp)
n <- 500
X <- expand_grid(x = seq(-2,1, length = n), d = seq(-1.1,1,length = n)) %>% filter(d < sin((x+2)*8))
F <- function(x) mean(X$x <= x)
# 1-F(0)
sigs = c(.05, .1, .16, .18, .3, .95)
df_br <-
expand_grid(m = seq(0, 1, .001), sig = sigs, ra = .4, rd = c(.2)) %>%
mutate(
x = (-m*ra +(1-m)*rd)*(1-sig)/sig,
m2 = 1 - sapply(x, F),
m2 = ifelse(m2<0, 0,m2),
m2 = ifelse(m2>1, 1,m2),
sigma = factor(sig))
df_br$sig2 <- factor(df_br$sig, sigs, TeX(paste0("$sigma=", sigs, "$")))
many_equilibria <-
df_br |>
ggplot(aes(m, m2)) + geom_line() + ylim(0:1) +
xlab("m: this many are attacking") + ylab(TeX("$mu$: this many will attack"))+ xlim(0:1) +
geom_abline(aes(intercept = 0, slope = 1), color = "black") + theme_bw() +
facet_grid(~sig2, labeller = "label_parsed")
many_equilibria
pdf("graphs_files/many.pdf", width = 12, height = 2.5)
many_equilibria
dev.off()
sigtop = .3
if(FALSE)
expand_grid(m = seq(0, 1, .01), sig = seq(.01, sigtop, .05), ra = .4, rd = .2) %>%
mutate(
x = (-m*ra +(1-m)*rd)*(1-sig)/sig,
m2 = 1 - sapply(x, F),
m2 = ifelse(m2<0, 0, m2),
m2 = ifelse(m2>1, 1, m2)) %>%
group_by(ra, rd, sig) %>%
mutate(
stable =   (sign(m-m2) > sign(lag(m)-lag(m2))) & (lag(m2)!=0),
unstable = sign(m-m2) < sign(lag(m)-lag(m2)),
pure = (m == 0 & m2 <= 0) | (m == 1 & m2 >= 1)) %>%
filter(stable | unstable | pure) %>% ungroup %>%
mutate(equilibrium =
ifelse(unstable, "unstable", "stable"),
equilibrium =  ifelse(pure, "stable", equilibrium)) %>%
write_rds("df.rds")
df_polygon <- data.frame(sig = c(0, sigtop, sigtop, 0), m = c(1/3, 1/3, 1-F(0), 1-F(0)), equilibrium = NA)
read_rds("df.rds") %>%
ggplot(aes(sig, m, color = equilibrium)) +  geom_point() +
ylab("Share attacking") + xlab("sigma") + theme_bw() + theme(legend.position = "none") +
geom_polygon(data = df_polygon, fill  = "lightgrey", color = "white", alpha = .5) + geom_point()
expand_grid(m = seq(0, 1, .01), sig = c(.2, .4, .6), ra = .5, rd = c(0, .1, .2)) %>%
data.frame() %>%
mutate(
m2 = 1 - (2/3)*((-m*ra +(1-m)*rd)/sig+1),
m2 = ifelse(m2<0, 0,m2),
m2 = ifelse(m2>1, 1,m2)
) %>%
ggplot(aes(m, m2)) + geom_line() +
facet_grid(sig~rd, labeller = label_both) + ylim(0:1) + xlab("m: this many are") + ylab("mu: this many will")+ xlim(0:1) + geom_abline(aes(intercept = 0, slope = 1), color = "#F8766D") + theme_bw()
ras <- c(.2, .41, .8, 1.62)
rds <- c(.2, .41, .8, 1.62)
df <- expand_grid(m = seq(0, 1, .001), sig = seq(.1, 1, .0005),
ra = ras, rd = rds) %>%
data.frame() %>%
mutate(
m2 = 1 - (2/3)*((-m*ra +(1-m)*rd)*(1-sig)/sig+1),
m2 = ifelse(m2<0, 0,m2),
m2 = ifelse(m2>1, 1,m2)
)
df_eq <- df %>%
group_by(ra, rd, sig) %>%
mutate(
stable =   (sign(m-m2) > sign(lag(m)-lag(m2))) & (lag(m2)!=0),
unstable = sign(m-m2) < sign(lag(m)-lag(m2)),
pure = (m == 0 & m2 <= 0) | (m == 1 & m2 >= 1)) %>%
filter(stable | unstable | pure) %>% ungroup %>%
mutate(equilibrium =
ifelse(unstable, "unstable", "stable"),
equilibrium =  ifelse(pure, "stable", equilibrium)
)
dfp <- expand_grid(ra = ras, rd = rds)
df_polygon <- bind_rows(
mutate(dfp, sig = 0, m = rd/(ra+rd)),
mutate(dfp, sig = 1, m = rd/(ra+rd)),
mutate(dfp, sig = 1, m = 1/3),
mutate(dfp, sig = 0, m = 1/3)
) %>% mutate(equilibrium = NA)
df_eq$ra2 <- factor(df_eq$ra, ras, TeX(paste0("$\\rho_A=",ras, "$")))
df_eq$rd2 <- factor(df_eq$rd, rds, TeX(paste0("$\\rho_D=",rds, "$")))
mean_df <- df_eq %>%
group_by(rd2, ra2) %>%
summarise(threshold = (2*ra + 2*rd)/( 3+ 2*ra + 2*rd))
main_plot <-
df_eq %>%
ggplot(aes(sig, m, color = equilibrium)) +
facet_grid(rd2 ~ra2, labeller = "label_parsed")  +
ylab("Share attacking") +
xlab( TeX("$sigma$")) +
theme_bw() + theme(legend.position = "none") +
geom_polygon(data = df_polygon, fill  = "lightgrey", color = "white", alpha = .5) +
geom_point() +
geom_vline(data = mean_df, aes(xintercept = threshold), colour = "darkgrey")
main_plot
pdf("graphs_files/main.pdf", width = 10, height = 5)
main_plot
dev.off()
x = seq(-1, 1, .05)
plot(x, dbeta((x+1)/2, 4, 6), xlab = "Pro autocracy", ylab = "density", type = "l")
sigs = c(.2, .4, .6)
rds <- c(.1, .3, .5)
df_br <-
expand_grid(m = seq(0, 1, .01), sig = sigs, ra = .4, rd = rds) %>%
data.frame() %>%
mutate(
m2 = 1 - pbeta(((-m^2*ra + (1-m^2)*rd)/sig + 1)/2, 4, 6),
m2 = ifelse(m2<0, 0,m2),
m2 = ifelse(m2>1, 1,m2)
)
df_br$sig2 <- factor(df_br$sig, sigs, TeX(paste0("$sigma=", sigs, "$")))
df_br$rd2 <- factor(df_br$rd, rds, TeX(paste0("$\\rho_D=",rds, "$")))
df_br |>
ggplot(aes(m, m2)) + geom_line() +
facet_grid(sig2~rd2, labeller = "label_parsed") +
ylim(0:1) + xlab("m: this many are attacking") +
ylab( TeX("$mu$: This many will attack")) +
xlim(0:1) + geom_abline(aes(intercept = 0, slope = 1), color = "#F8766D") + theme_bw()
df <- expand_grid(m = seq(0, 1, .002),
sig = seq(.1, 2, .001),
ra = c(0, .2, .6, 1.2),
rd = c(0, .2, .41, .8)) %>%
data.frame() %>%
mutate(
m2 = 1 - pbeta(((-m^2*ra + (1-m^2)*rd)*(1-sig)/sig + 1)/2, 4, 6),
m2 = ifelse(m2<0, 0,m2),
m2 = ifelse(m2>1, 1,m2)
)
df_eq <- df %>%
group_by(ra, rd, sig) %>%
mutate(
stable =   (sign(m-m2) > sign(lag(m)-lag(m2))) & (lag(m2)!=0),
unstable = sign(m-m2) < sign(lag(m)-lag(m2)),
pure = (m == 0 & m2 <= 0) | (m == 1 & m2 >= 1)) %>%
filter(stable | unstable | pure) %>% ungroup %>%
mutate(equilibrium =
ifelse(unstable, "unstable", "stable"),
equilibrium =  ifelse(pure, "stable", equilibrium)
)
df_eq %>% ggplot(aes(sig, m, color = equilibrium)) + facet_grid(rd ~ra, labeller = "label_both") + geom_point() + ylab("Share attacking") + xlab("sigma") + theme_bw() + theme(legend.position = "none")
rds <- ras <- c(.2, 1, 5.5, 25)
df <- expand_grid(m = seq(0, 1, .001), sig = seq(.1, 1, .0002),
ra = ras, rd = rds) %>%
data.frame() %>%
mutate(
m2 = 1 - pbeta(((-m^1.5*ra + (1-m^1.5)*rd)*(1-sig)/sig + 1)/2, 5.53, 7)
)
? draw
dfp
df_polygon
main_plot <-
df_eq %>%
ggplot(aes(sig, m, color = equilibrium)) +
facet_grid(rd2 ~ra2, labeller = "label_parsed")  +
ylab("Share attacking") +
xlab( TeX("$sigma$")) +
theme_bw() + theme(legend.position = "none") +
geom_polygon(data = df_polygon, fill  = "lightgrey", color = "white", alpha = .5) +
geom_point() +
geom_vline(data = mean_df, aes(xintercept = threshold), colour = "darkgrey")
main_plot
main_plot
